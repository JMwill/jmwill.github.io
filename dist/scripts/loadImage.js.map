{"version":3,"sources":["loadImage.js"],"names":[],"mappings":"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","file":"loadImage.js","sourcesContent":["/*eslint-env es6*/\n;(function (hook) {\n    function _loadedImg (evt) {\n        let prop = this.prop;\n\n        this.fadeOut(0.3);\n        setTimeout(() => {\n            console.log(prop.imgContainer.src);\n            prop.elem.style.backgroundImage = `url(${prop.imgContainer.src})`;\n            prop.imgLoading = false;\n            this.fadeIn();\n        }, prop.options.fadeTime * 1000);\n\n        if (prop.cb) {\n            prop.cb();\n            delete prop.cb;\n        }\n    }\n\n    function _loadWithError (evt) {\n        let prop = this.prop;\n        prop.imgLoading = false;\n        console.log('Can not load image');\n    }\n    function BgImageLoader(elem) {\n\n        if (!elem) {\n            throw new Error(`Image Loader Running Wrong!, elem: ${elem}`);\n        }\n        elem = $(elem);\n\n\n        /**********************************\n         * property\n         **********************************/\n        this.prop = {\n            elem: elem,\n            imgContainer: new Image(),\n            imgLoading: false\n        };\n\n        this.DEFAULT = {\n            timeout: 10000,\n            fadeTime: 1\n        };\n        /**********************************/\n\n        this.prop.imgContainer.addEventListener('load', _loadedImg.bind(this));\n        this.prop.imgContainer.addEventListener('error', _loadWithError.bind(this));\n    }\n\n    BgImageLoader.prototype.init = function (urls, options, cb) {\n        let prop = this.prop;\n        let isString = utils.isType('String');\n        let isArray = utils.isType('Array');\n        let isFunction = utils.isType('Function');\n\n        prop.options = utils.deepExtend({}, this.DEFAULT, options);\n\n        if (isString(urls)) {\n            this.loadImg(urls);\n        } else if (isArray(urls)) {\n            prop.randomBgImg =\n                setInterval(() => {\n                    if (prop.imgLoading) return ;\n                    this.loadImg(\n                        this.randomUrl(urls)\n                    );\n                }, prop.options.timeout);\n\n            // load first image\n            this.loadImg(\n                urls[parseInt(Math.random() * urls.length)]\n            );\n        }\n\n        if (isFunction(cb)) { this.prop.cb = cb; }\n    };\n\n    BgImageLoader.prototype.randomUrl = function (urls) {\n        let prop = this.prop;\n        var url = urls[parseInt(Math.random() * urls.length)];\n        if ( url === prop.imgContainer.src) {\n            url = this.randomUrl(urls);\n        }\n        return url;\n    };\n\n    BgImageLoader.prototype.loadImg = function (url) {\n        let prop = this.prop;\n        prop.imgContainer.src = url;\n        prop.imgLoading = true;\n    };\n\n    BgImageLoader.prototype.fadeOut = function (val = 0) {\n        let prop = this.prop;\n        let style = window.getComputedStyle(prop.elem);\n        prop.oldTransitionProperty = style.transitionProperty;\n\n        let transStr = `opacity ${prop.options.fadeTime}s linear`;\n        prop.elem.style.WebkitTransition = transStr;\n        prop.elem.style.MozTransition = transStr;\n\n        prop.elem.style.opacity = val;\n    };\n\n    BgImageLoader.prototype.fadeIn = function (val = 1) {\n        let prop = this.prop;\n        prop.elem.style.opacity = val;\n    };\n\n    hook.BgImageLoader = BgImageLoader;\n\n})(Page);\n"],"sourceRoot":"/source/"}